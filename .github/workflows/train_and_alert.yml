name: Crypto AI Hybrid v13.3 - Train & Alert

on:
  schedule:
    - cron: "*/30 * * * *"  # Every 30 minutes
  workflow_dispatch:

env:
  USE_COINGECKO_DEMO: "true"  # Use demo API; set to false when switching to Pro
  COINGECKO_API_KEY: ""       # Optional if demo mode is true
  PYTHONUNBUFFERED: "1"

jobs:
  run-bot:
    runs-on: ubuntu-latest

    steps:
      # Step 1: Checkout repository
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          persist-credentials: true
          fetch-depth: 0

      # Step 2: Setup Python
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      # Step 3: Ensure folder structure and commit gitkeep if missing
      - name: Ensure folder structure and commit .gitkeep
        run: |
          echo "[SETUP] Creating required folders..."
          mkdir -p models/models_spike models/spike_trend data_cache training_summary

          # Ensure empty .gitkeep in each
          touch models/.gitkeep
          touch models/spike_trend/.gitkeep
          touch data_cache/.gitkeep
          touch training_summary/.gitkeep

          echo "[OK] Folder structure ready:"
          tree -d -L 2 || ls -R .

          # Comm
